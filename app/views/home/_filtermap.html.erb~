<%=@map.div(:width => 630, :height => 280).html_safe %>
<%= javascript_tag do %>
        function LabeledMarker(latlng, options){
        		this.latlng = latlng;
        		this.labelText = options.labelText || "";
        		this.labelClass = options.labelClass || "markerLabel";
        		this.labelOffset = options.labelOffset || new GSize(0, 0);
        		GMarker.apply(this, arguments);
        }
			  var map = new GMap2(document.getElementById("map_div"));
        map.setCenter(new GLatLng(13.83333,100.522413), 13);
        map.setUIToDefault();
        <%@stations = StationsTranslation.all%>
        	<%@stations.each_with_index do |station,index| %>
           var latlng = new GLatLng(<%=station.latitude%>,<%=station.longtitude%>);
           
        	  var icon = new GIcon();
        	  icon.image = './images/purple_marker.png';
        	  icon.iconSize = new GSize(32, 32);
        	  icon.iconAnchor = new GPoint(16, 16);
        	  icon.infoWindowAnchor = new GPoint(25, 7);

        	  opts = {
        	  		'icon': icon,
        	  		'clickable': true,
        	  		'labelText': '<%=station.code%>',
        	  		'labelOffset': new GSize(-16, -16)
        	  		};

           var marker = new LabeledMarker(latlng,opts);
           GEvent.addListener(marker, "click", function() {
           		 marker.openInfoWindowHtml('<p class="badge"><%=station.code%><p><%=station.title%>');
            });

           map.addOverlay(marker);   

        


        	<%end%>
<% end %>
